{"version":3,"sources":["webpack:///webpack/bootstrap f9d127da90ad4ebf7a24","webpack:///external \"react\"","webpack:///./config/core.js","webpack:///./config/target.js","webpack:///external \"osnova\"","webpack:///./src/server/cluster-launcher.js","webpack:///./src/components/Counter/index.js","webpack:///./src/components/caption/index.js","webpack:///./src/server/master.js","webpack:///./src/server/modules/express-middlewares.js","webpack:///./src/server/modules/send-html.js","webpack:///./src/server/modules/socket-events.js","webpack:///./src/server/worker.js","webpack:///./src/utils/core.js","webpack:///./src/components/Counter/style.css","webpack:///./src/components/caption/style.css","webpack:///external \"body-parser\"","webpack:///external \"cookie-parser\"","webpack:///external \"fs\"","webpack:///external \"osnova-cluster-launcher\"","webpack:///external \"osnova-module-socket.io\"","webpack:///external \"path\"","webpack:///external \"react-dom/server\"","webpack:///./src/server/index.js"],"names":["require","host","database","module","exports","paths","absolute","root","process","cwd","assets","session","secret","env","localSettings","threads","port","NODE_PORT","ip","NODE_IP","uri","herokuSettings","PORT","getDeployTargetConfig","ON_HEROKU","targetConfig","launch","worker","main","master","config","counterProps","value","number","onIncrement","func","onDecrement","Counter","label","button","propTypes","Caption","caption","props","text","PropTypes","string","masterCoreOpts","modules","listen","osnova","core","start","console","log","pid","middlewares","express","app","Error","use","json","urlencoded","extended","next","cookieParser","v","getCounter","generateHtmlString","opts","manifest","JSON","parse","readFileSync","resolve","assetsPath","distPath","sendHtml","htmlString","get","req","res","send","createEvent","type","action","registerEvents","registrator","events","Object","keys","forEach","event","i","socketEvents","io","_io","native","on","socket","payload","emit","id","DEBUG","stringsToObjectKeys","strings","initializer","undefined","reduce","prev","cur"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 22);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f9d127da90ad4ebf7a24","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 0\n// module chunks = 0","// Created by snov on 03.02.2017.\r\n\"use strict\";\r\n\r\nconst { host, database } = require('./target');\r\n\r\nmodule.exports = {\r\n  paths: {\r\n    absolute: {\r\n      root: process.cwd()\r\n    },\r\n    assets: './static/'\r\n  },\r\n  host,\r\n  database,\r\n  session: {\r\n    secret: 'VERYSECRETSTRING'\r\n  }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./config/core.js","// Created by snov on 03.02.2017.\r\n//\r\n// deployment to specific platform settings\r\n//\r\n//=========================================================================\r\n\r\nconst env  = process.env;\r\n\r\nconst localSettings = {\r\n  threads: 1,//require('os').cpus().length,\r\n\r\n  host: {\r\n    port: env.NODE_PORT || 3322,\r\n    ip: env.NODE_IP || '127.0.0.1'\r\n  },\r\n\r\n  database: {\r\n    uri: 'mongodb://localhost/osnovareactenvironment'\r\n  }\r\n};\r\n\r\n//=========================================================================\r\n// for development mode in heroku\r\n// $ heroku config:set NPM_CONFIG_PRODUCTION=false\r\nconst herokuSettings = {\r\n  threads: 1,\r\n\r\n  host: {\r\n    port: env.PORT || 5000,\r\n    ip: env.NODE_IP || '0.0.0.0'\r\n  },\r\n\r\n  database: {\r\n    // https://devcenter.heroku.com/articles/mongolab/\r\n    // $ heroku config:get MONGODB_URI\r\n    uri: 'mongodb://user:passs@x.mlab.com:33966/user'\r\n  }\r\n};\r\n\r\nfunction getDeployTargetConfig() {\r\n  //$ heroku config:set ON_HEROKU=true\r\n  if (env.ON_HEROKU) {\r\n    return herokuSettings;\r\n  }\r\n\r\n  return localSettings;\r\n}\r\n\r\nconst targetConfig = getDeployTargetConfig();\r\n\r\nmodule.exports = exports = {\r\n  host: targetConfig.host,\r\n  database: targetConfig.database,\r\n  threads: targetConfig.threads\r\n};\n\n\n// WEBPACK FOOTER //\n// ./config/target.js","module.exports = require(\"osnova\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"osnova\"\n// module id = 3\n// module chunks = 0","// Created by snov on 09.02.2017.\r\n//\r\n// Multiprocess cluster launcher config\r\n//\r\n//=========================================================================\r\n\r\nconst { launch } = require('osnova-cluster-launcher');\r\nconst { host, threads } = require('../../config/target');\r\n\r\n// 'worker.listen' and 'master.listen' will be set to default sticky listens\r\n// from osnova-cluster-launcher\r\nlaunch({\r\n  worker: { main: require('./worker') },\r\n  master: { main: require('./master') },\r\n  config: { threads, host }\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/server/cluster-launcher.js","// Created by snov on 12.02.2017.\r\n//\r\n// Counter react component\r\n//\r\n//=========================================================================\r\n\r\nimport React, { PropTypes } from 'react';\r\nimport styles from './style.css';\r\n\r\nconst counterProps = {\r\n  value: PropTypes.number,\r\n  onIncrement: PropTypes.func,\r\n  onDecrement: PropTypes.func\r\n};\r\n\r\nconst Counter = ({ value, onIncrement, onDecrement}) => (\r\n  <div>\r\n    <h1 className={styles.label}>{value}</h1>\r\n    <button className={styles.button} onClick={onIncrement}>+</button>\r\n    <button className={styles.button} onClick={onDecrement}>-</button>\r\n  </div>\r\n);\r\n\r\nCounter.propTypes = counterProps;\r\n\r\nexport default Counter;\n\n\n// WEBPACK FOOTER //\n// ./src/components/Counter/index.js","// Created by snov on 01.02.2017.\r\nimport React, { Component } from 'react';\r\nimport styles from './style.css';\r\n\r\nexport default class Caption extends Component {\r\n\r\n  static propTypes = {\r\n    text: React.PropTypes.string\r\n  };\r\n\r\n  static defaultProps = {\r\n    text: 'Caption'\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.caption}>{this.props.text}\r\n      </div>\r\n    )\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/caption/index.js","// Created by snov on 19.09.2016.\r\n\r\nimport OSNOVA from 'osnova';\r\nimport { stringsToObjectKeys } from '../utils/core';\r\n\r\n// creating a copy of a default core options, because we don't want to modify the original\r\nconst masterCoreOpts = {...require('../../config/core')};\r\n\r\n// we dont need these core modules on the master process\r\nconst modules = stringsToObjectKeys(['webserver', 'socketio', 'session'], false);\r\nmasterCoreOpts.modules = {...masterCoreOpts.modules, ...modules};\r\n\r\nmodule.exports = (listen) => {\r\n\r\n  const osnova = OSNOVA({\r\n    master: true,\r\n    modules: [],\r\n    core: masterCoreOpts,\r\n    listen\r\n  });\r\n\r\n  osnova.start(() => {\r\n    console.log(`Hello from master! [pid=${process.pid}]`);\r\n  });\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/server/master.js","// Created by snov on 13.02.2017.\r\n//\r\n// Define some express middlewares\r\n//\r\n//=========================================================================\r\n\r\nimport bodyParser from 'body-parser';\r\nimport cookieParser from 'cookie-parser';\r\n\r\nexport default function middlewares({ express } = {}) {\r\n  return (osnova) => {\r\n    const app = express || osnova.express;\r\n\r\n    if (!app) {\r\n      throw new Error('No express object were provided.');\r\n    }\r\n\r\n    app.use(bodyParser.json());\r\n    app.use(bodyParser.urlencoded({ extended: true }));\r\n    app.use(cookieParser());\r\n\r\n    if (typeof osnova == 'object') {\r\n      osnova.next({cookieParser});\r\n    }\r\n  };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/server/modules/express-middlewares.js","// Created by snov on 10.02.2017.\r\n//\r\n// Generates HTML based on Webpack bundle\r\n//\r\n//=========================================================================\r\n\r\nimport path from 'path';\r\nimport fs from 'fs';\r\n\r\n\r\nimport React from 'react';\r\n/* eslint-disable no-unused-vars */\r\nimport reactDOM, { renderToString } from 'react-dom/server';\r\n/* eslint-enable no-unused-vars */\r\n\r\nimport Caption from '../../components/caption';\r\nimport Counter from '../../components/Counter';\r\n\r\nlet v = 100;\r\n\r\nconst getCounter = <Counter value={v}\r\n  onIncrement={() => v++ }\r\n  onDecrement={() => v-- }\r\n/>;\r\n\r\nconst generateHtmlString = (opts) => {\r\n  const manifest = JSON.parse(fs.readFileSync(path.resolve(opts.assetsPath, opts.distPath, 'manifest.json'), 'utf8'));\r\n\r\n  return `\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <link rel=\"stylesheet\" type=\"text/css\" href=${opts.distPath+manifest['index.css']}>\r\n  <title>Osnova-react-environment application</title>\r\n</head>\r\n<body>\r\n    <div id=\"app\"></div>\r\n    <script>window.serverData=${v}</script>\r\n    <script rel=\"script\" src=${opts.distPath+manifest['manifest.js']}></script>\r\n    <script rel=\"script\" src=${opts.distPath+manifest['vendor.js']}></script>\r\n    <script rel=\"script\" src=${opts.distPath+manifest['index.js']}></script>\r\n    ${renderToString(<Caption text=\"hello?\"/>)}\r\n    ${renderToString(getCounter)}\r\n</body>\r\n</html>\r\n`\r\n};\r\n\r\nconst sendHtml = (/*opts*/) => osnova => {\r\n  const app = osnova.express;\r\n  const htmlString = generateHtmlString({\r\n    assetsPath: osnova.opts.core.paths.assets,\r\n    distPath: './dist/'\r\n  });\r\n\r\n  app.get('*', (req, res) => {\r\n    res.send(htmlString);\r\n  });\r\n\r\n  osnova.next();\r\n};\r\n\r\nexport default sendHtml;\n\n\n// WEBPACK FOOTER //\n// ./src/server/modules/send-html.js","// Created by snov on 10.02.2017.\r\n//\r\n// Socket events\r\n//\r\n//=========================================================================\r\n\r\n/* eslint-disable no-unused-vars */\r\n\r\nconst createEvent = (type, action) => {\r\n  return {\r\n    type,\r\n    action\r\n  }\r\n};\r\n\r\nconst registerEvents = (registrator, events) => {\r\n  Object.keys(events).forEach((event, i) => {\r\n\r\n  });\r\n};\r\n\r\nconst socketEvents = opts => osnova => {\r\n  const io = osnova.io;\r\n  const _io = io.native();\r\n  if (typeof io == 'undefined') {\r\n    throw new Error('osnova.io is undefined. Turn on socketio in osnova.opts.core.modules!');\r\n  }\r\n\r\n  // createEvent('count-increment', (io, socket, data) => {\r\n  //   io.emit('counter-update');\r\n  // });\r\n\r\n  io.on('counter-increment', (socket, payload) => {\r\n    _io.emit('counter-updated', 1);\r\n  });\r\n\r\n  io.on('counter-decrement', (socket, payload) => {\r\n    _io.emit('counter-updated', -1);\r\n  });\r\n\r\n  io.on('client-message', (socket, payload) => {\r\n    console.log(socket.id, payload);\r\n  });\r\n\r\n  osnova.next();\r\n};\r\n/* eslint-enable no-unused-vars */\r\n\r\nexport default socketEvents;\n\n\n// WEBPACK FOOTER //\n// ./src/server/modules/socket-events.js","// Created by snov on 22.06.2016.\r\n\r\nimport OSNOVA from 'osnova';\r\nimport socketEvents from './modules/socket-events';\r\nimport sendHtml from './modules/send-html';\r\nimport expressMiddlewares from './modules/express-middlewares';\r\nimport socketIOModule from 'osnova-module-socket.io';\r\n\r\n//import socketAuth from './socketio/auth';\r\n\r\nmodule.exports = (listen) => {\r\n\r\n  const osnova = OSNOVA({\r\n    modules: [\r\n      expressMiddlewares(),\r\n      sendHtml(),\r\n      socketIOModule(),\r\n      socketEvents()\r\n    ],\r\n    core: require('../../config/core'),\r\n    listen,\r\n    DEBUG: {\r\n      modules: false\r\n    }\r\n  });\r\n\r\n  osnova.start(() => {\r\n    console.log(`Hello from worker! [pid=${process.pid}]`);\r\n  });\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/server/worker.js","// Created by snov on 12.02.2017.\r\n//\r\n// Core utility library\r\n//\r\n///////////////////////////////////////////////////////////////\r\n\r\n// Converts array of strings to an object with these strings as keys.\r\n//\r\n// @param strings { Array }\r\n// @param initializer { any } optional, default = undefined:\r\n//    - undefined: the every key will be set to itself\r\n//    - function {key => value}: it will be executed on the every key to produce the value\r\n//    - other: the every key will be set to initializer.\r\n// @returns { Object }\r\n//\r\n// f(['a', 'b', 'c'], 1) == { a: 1, b: 1, c: 1 }\r\n// f(['a', 'b', 'c']) == { a: 'a', b: 'b', c: 'c' }\r\n// f(['a', 'b', 'c'], v => v + '!') == { a: 'a!', b: 'b!', c: 'c!' }\r\nexport function stringsToObjectKeys(strings = [], initializer = undefined) {\r\n  if (typeof strings != 'object' || typeof strings.reduce != 'function') {\r\n    return {};\r\n  }\r\n\r\n  return strings.reduce((prev, cur) => {\r\n    if (typeof initializer == 'undefined') {\r\n      prev[cur] = cur\r\n    } else if (typeof initializer == 'function') {\r\n      prev[cur] = initializer(cur);\r\n    } else {\r\n      prev[cur] = initializer;\r\n    }\r\n    return prev;\r\n  }, {});\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/core.js","module.exports = {\n\t\"button\": \"button--1nk_y\",\n\t\"label\": \"label--1zxjw\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Counter/style.css\n// module id = 13\n// module chunks = 0","module.exports = {\n\t\"caption\": \"caption--w3nRo\"\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/caption/style.css\n// module id = 14\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"osnova-cluster-launcher\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"osnova-cluster-launcher\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"osnova-module-socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"osnova-module-socket.io\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"react-dom/server\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom/server\"\n// module id = 21\n// module chunks = 0","// Created by snov on 28.06.2016.\r\n//\r\n\r\n// launch via cluster launcher\r\nrequire('./cluster-launcher');\r\n\r\n// or comment above and uncomment below for single process server\r\n//require('./worker')('default');\n\n\n// WEBPACK FOOTER //\n// ./src/server/index.js"],"sourceRoot":""}